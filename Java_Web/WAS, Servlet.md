## JSP와 Servlet

### WAS (웹 어플리케이션 서버)

- 클라이언트가 정적인 페이지가 아닌 동적인 페이지를 요구할 때, 코드를 실행하여 실행된 결과를 웹 서버에 돌려줄 수 있도록 하는 환경

  - 웹 서버는 처리한 결과를 클라이언트에게 전달(응답)한다.
  - 웹 서버는 정적 컨텐츠만을 처리
  - WAS를 통해 그때그때 요청에 맞는 데이터를 DB에서 가져와 결과를 만들어서 제공한다.

  > 1. 웹 서버가 클라이언트로부터 HTTP 요청을 받음
  > 2. 웹 서버는 요청을 WAS에 보냄
  > 3. WAS는 관련 Servlet을 메모리에 올린다.
  > 4. 스레드 생성
  > 5. HttpServletRequest와 HttpServletResponse 객체를 생성하여 Servlet에 전달
  > 6. Thread는 Servlet의 service() 메서드를 호출
  > 7. service() 메서드는 요청에 맞게 doGet() 또는 doPost() 메서드를 호출
  > 8. doGet() 또는 doPost() 메서드는 인자에 맞게 생성된 적절한 동적 페이지를 Response 객체에 담아 WAS에 전달
  > 9. WAS는 Response 객체를 HttpResponse 형태로 바꾸어 Web Server에 전달
  > 10. 생성된 Thread를 종료하고, HttpServletRequest와 HttpServletResponse 객체를 제거

- 동적으로 문서를 만들기 위한 코드들을 Server Application 이라고 함

- 즉 서버 환경 : 웹 서버 + WAS (이 둘은 상호작용)

- WAS : 웹 컨테이너 + Servlet 구현체 (이 둘은 상호작용)

---

### Servlet

- 웹 서버 응용 프로그램
- 웹 기반의 요청에 대해 동적인 처리가 가능한 하나의 클래스
- 서버 사이드에서 실행되는 자바 프로그램
- 사용자가 요청하는 내용들 : 리스트, 등록, 삭제, 수정 등
- 그때그때 요청에 맞는 코드들이 따로 있어서 실행되고, 클라이언트에게 전달되고 나면 종료한다.
- **Servlet Context** : 
  - 각 서블릿 요청 시, 실행 후 메모리에서 사라짐.
  - 2번 서블릿 사용 시, 1번 서블릿에서 처리한 내용을 가지고 새로운 결과물을 만들 수 있도록 상태를 저장하는 공간
- **서블릿 인터페이스에 정의된 메서드**
  - Init : 서블릿 인스턴스 생성(초기화)
  - Service : 실제 기능이 수행되는 곳
    - HTTP 메서드에 따라 doGet()등 알맞는 메서드 호출
  - Destroy
    - 보통 컨테이너가 종료되는 시점에 호출된다.
    - 서블릿 인스턴스 사라짐
  - 각 메서드는 서블릿 컨테이너(ex. Tomcat)이 호출해준다.
- 싱글톤이기 때문에 지역변수는 스레드마다 독립적으로 생성되고, 메모리는 공유한다.
- 

---

### 웹 컨테이너

- 또는 서블릿 컨테이너

- 톰캣 등..

- 자바 서블릿과 상호작용

- 웹 컨테이너는 서블릿의 생명주기를 관리하고, URL과 특정 서블릿을 맵핑하며 URL 요청이 올바른 접근 권한을 갖도록 보장한다.

- 요청이 들어오면 스레드를 생성하고, 서블릿을 실행시킴

- 서블릿 인터페이스에 따라 서블릿 관리, 메서드 호출

- Web.xml

  - 웹 컨테이너가 가지는 설정 파일
  - WAS에게 서블릿 객체 - URL 매핑 정보를 알려준다.
    - 특정 url 리퀘스트가 들어오면 이 서블릿으로 보내라..
  - 이 매핑된 것을 보고, 예를 들어 doPost() 실행 시
    - Request의 parameter를 받는다.
    - 비즈니스 로직을 처리
    - 결과 data를 담은 view 생성
    - client에게 전송

  

  


